"use strict";(self.webpackChunkSHEIN_W=self.webpackChunkSHEIN_W||[]).push([[75872],{775872:function(t,e,i){i.d(e,{VK:function(){return A},fZ:function(){return S},lD:function(){return b}});var s=i(280030),h=i(121114),r=(i(665640),Object.defineProperty),c=(t,e,i)=>(((t,e,i)=>{e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const o="RESOURCE_ADAPT",p=`${o}_WEBP`;var u=(t=>(t[t.Level0=0]="Level0",t[t.Level1=1]="Level1",t[t.Level2=2]="Level2",t[t.Level3=3]="Level3",t))(u||{});const n="_thumbnail_",a=["img.shein.com","img.romwe.com","img.ltwebstatic.com","file.ltwebstatic.com","imgdeal-test01.shein.com"],l={"320-720":720,"720-1080":720,"1080-1280":1080,"1280-1440":1280,"1440-1680":1440,"1680-1920":1680,"1920-3080":1920,"3080-4080":1920};class b{constructor(t){c(this,"deviceWidth",0),c(this,"isSupportWebp",!1),c(this,"serverSupportWebp",!1),c(this,"isMoble",!1),c(this,"designSize",0),c(this,"calculateWidth",0),c(this,"score",0),c(this,"isServer",!1),c(this,"isCookieSet",!1),c(this,"isSupprotCut",!1),c(this,"currentScene",""),c(this,"sceneMap",{}),c(this,"init",(t=>{this.setIsServer(),this.setDeviceData(t),this.setSupportWebpState(),this.isServer||(this.isSupportWebp?this.setLocaWebpState("true"):this.serverSupportWebp&&this.checkClientSupportWebp())})),c(this,"setIsServer",(()=>{this.checkIsServer()&&(this.isServer=!0)})),c(this,"setDeviceData",(t=>{const{width:e,isMobile:i,score:s,isSupportWebp:h,isSupprotCut:r,sceneMap:c,scene:o}=t;this.isMoble=i||!1,this.isSupprotCut=r||!1,this.serverSupportWebp=h||!1,this.deviceWidth=this.getDeviceWidth(e),this.score=s||0,this.sceneMap=c||{},this.currentScene=o||"",h&&(this.isSupportWebp=h),this.designSize=i?750:1366,this.calculateWidth=this.getCalculateWidth()})),c(this,"getDeviceWidth",(t=>{const e=t||this.getDefaultDeviceWidthByCookie();return!this.isMoble&&e<=1920?1920:e})),c(this,"getDefaultDeviceWidthByCookie",(()=>this.isMoble?375:1366)),c(this,"setSupportWebpState",(()=>{this.isServer||this.serverSupportWebp&&(this.isSupportWebp=Boolean(this.getLocalWebpState()))})),c(this,"checkClientSupportWebp",(()=>{(this.checkSupportWebpByCanvas()||this.checkSupportWebpByElement())&&(this.isSupportWebp=!0,this.setLocaWebpState("true")),this.checkSupportWebpByBase64()})),c(this,"checkIsServer",(()=>"undefined"==typeof window)),c(this,"getCalculateWidth",(()=>{const t=Object.keys(l),e=this.isMoble?2*this.deviceWidth:this.deviceWidth;for(let i=0;i<t.length;i++){const[s,h]=t[i].split("-");if(e>=Number(s)&&e<Number(h)||i===t.length-1&&e>=Number(h))return this.calculateWidthByScore(i,t)}return 720})),c(this,"calculateWidthByScore",((t,e)=>{let i=e[t];if(this.score===u.Level3||this.score===u.Level2||this.score===u.Level0)return l[i];if(this.score===u.Level1){i=e[t-1>=0?t-1:0]}return l[i]})),c(this,"getLocalKey",(()=>`${o}__WEBP_SUPPORT`)),c(this,"getLocalWebpState",(()=>localStorage.getItem(this.getLocalKey())||!1)),c(this,"setLocaWebpState",(t=>{var e;(localStorage.setItem(this.getLocalKey(),t),this.isCookieSet)||(this.isCookieSet=!0,e=!0,!(0,s.R)(p)&&e&&(0,h.T)({key:p,value:"1",path:"/"}))})),c(this,"checkSupportWebpByBase64",(()=>{const t=new Image;t.onload=()=>{t.width>0&&t.height>0&&!this.isSupportWebp&&(this.isSupportWebp=!0,this.setLocaWebpState("true"))},t.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="})),c(this,"checkSupportWebpByCanvas",(()=>{const t=document.createElement("canvas");return t&&0===t.toDataURL("image/webp").indexOf("data:image/webp")})),c(this,"checkSupportWebpByElement",(()=>{let t;try{const e=document,i=e.createElement("object");i.type="image/webp",i.innerHTML="!",e.body.appendChild(i),t=!i.offsetWidth,e.body.removeChild(i)}catch(e){t=!1}return t})),c(this,"cutWidth",((t,e,i)=>{let s=t*this.calculateWidth/this.designSize;if(s=48*Math.round(s/48),i&&s<i)return i;if(e&&s>e)return e;const h=this.isMoble?2:4,r=Math.floor(t+48*h);return Math.floor(s)>r?r:Math.floor(s)})),c(this,"isSupportCutImgType",(t=>/\b(\.webp|\.png|\.jpg\b)/.test(t))),c(this,"isSupportCutImg",(t=>a.some((e=>t.indexOf(e)>-1)))),c(this,"img2Webp",((t,e)=>e?t.replace(/\b(\.jpg|\.png|\.gif)\b/,".webp"):t)),c(this,"getCutToNum",((t,e,i)=>i&&t<i?i:e&&t>e?e:t)),c(this,"checkIsGif",(t=>/\b(\.gif\b)/.test(t))),c(this,"cutImg",(({imgUrl:t,width:e,max:i,min:s,cutTo:h})=>{const r=t.indexOf(n)>-1,c=this.cutWidth(e,i,s);if(r)return t.replace(/(\d+)x(\d*)(\.)(webp|png|jpg)$/,(t=>{const[e,r]=t.split("."),[o]=e.split("x");if(h&&"number"==typeof h&&!Number.isNaN(h)){return`${this.getCutToNum(h,i,s)}x.${r}`}return`${c>Number(o)?Number(o):c}x.${r}`}));const o=t.lastIndexOf("."),p=t.slice(o);if(h&&"number"==typeof h&&!Number.isNaN(h)){const e=this.getCutToNum(h,i,s);return`${t.slice(0,o)}${n}${e}x${p}`}return`${t.slice(0,o)}${n}${c}x${p}`})),c(this,"transfromImg",(({imgUrl:t="",width:e=0,exp:i={}})=>{const{unCut:s=0,max:h=0,min:r=0,cutTo:c=0}=i||{},o=this.checkIsGif(t);if(!t)return"data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=";const p=this.isSupportCutImg(t);this.isSupportWebp&&(t=this.img2Webp(t,p));const u=!this.currentScene||this.sceneMap[this.currentScene]&&Boolean(this.sceneMap[this.currentScene]);return this.isSupprotCut&&p&&u&&e&&!s&&!o&&this.isSupportCutImgType(t)&&(t=this.cutImg({imgUrl:t,width:e,max:h,min:r,cutTo:Number(c)})),t.replace(/^\w+:/,"")})),c(this,"updataScore",(t=>{this.score=t||0,this.calculateWidth=this.getCalculateWidth()})),c(this,"updateScene",(t=>{this.currentScene=t})),this.init(t)}}const A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEXMzMzKUkQnAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==";const S=(t={})=>{let e="";const i=Object.keys(t);return i.forEach(((s,h)=>{e+=`${s}=${t[s]}${h!==i.length-1?"#":""}`})),e}}}]);
//# sourceMappingURL=75872-80f38a35f683a02a.js.map